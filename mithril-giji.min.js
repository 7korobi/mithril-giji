/**
 mithril-giji - mithril library for 人狼議事
 @version v0.0.16
 @link https://github.com/7korobi/mithril-giji
 @license 
**/


(function(){var a,b,c;b=function(a){return a.left=window.scrollX,a.top=window.scrollY},a=function(){var a,d,e,f;if(!c.scrolling)return a={},e=0,d=function(){var c;return c={},b(c),a.top===c.top&&a.left===c.left?10<e++:(a=c,e=0,!1)},(f=function(){d()?(c.scrolling=!1,c.do_event_list(c.on.scroll_end),c["do"].resize()):window.requestAnimationFrame(f)})()},module.exports=c={do_event_list:function(a,b){var c,d,e;if(0<a.length)for(d=0,e=a.length;e>d;d++)(c=a[d])(b)},"do":{layout:function(a){return c.do_event_list(c.on.layout,a)},resize:function(a){var b;return b=document.documentElement,c["short"]=Math.min(b.clientWidth,b.clientHeight),c.width=b.clientWidth,window.innerHeight>window.innerWidth?(c.landscape=!1,c.portlate=!0):(c.landscape=!0,c.portlate=!1),c.do_event_list(c.on.resize,a)},scroll_end:a,scroll:function(a){return b(c),c.height=window.innerHeight,c.right=c.left+window.innerWidth,c.bottom=c.top+c.height,c.horizon=c.height/2,c.scrolling||c.do_event_list(c.on.scroll_start,a),c["do"].scroll_end(),c.scrolling=!0,c.do_event_list(c.on.scroll,a)},orientation:function(a){return c.orientation=a,c.compass=a.webkitCompassHeading,c.do_event_list(c.on.orientation,a)},motion:function(a){return c.accel=a.acceleration,c.gravity=a.accelerationIncludingGravity,c.rotate=a.rotationRate,c.do_event_list(c.on.motion,a)},load:function(a){return c.do_event_list(c.on.load,a),c["do"].resize(),c["do"].scroll(),c["do"].layout()}},on:{layout:[],resize:[],scroll:[],scroll_start:[],scroll_end:[],orientation:[],motion:[],load:[]},scroll:null,layout:null,mount:function(a,b){return b?c.on.load.push(function(){var c;return c=document.querySelector(a),c&&b?m.mount(c,b(c)):void 0}):void 0},top:0,horizon:0,bottom:0,left:0,right:0,height:0,width:0,"short":0,browser:{},accel:{},rotate:{},gravity:{},orientation:{},compass:0,is_tap:!1,deploy:function(){return"onorientationchange"in window?window.addEventListener("orientationchange",c["do"].scroll):window.addEventListener("resize",c["do"].scroll),window.addEventListener("scroll",c["do"].scroll),"ondeviceorientation"in window&&window.addEventListener("deviceorientation",c["do"].orientation),"ondevicemotion"in window&&window.addEventListener("devicemotion",c["do"].motion),"onhashchange"in window&&window.addEventListener("hashchange",function(a){return a.clipboardData?console.log(a):Url.popstate()}),"onpopstate"in window&&(window.addEventListener("popstate",function(a){return a.clipboardData?console.log(a):Url.popstate()}),head.browser.safari||Url.popstate()),"onmessage"in window&&window.addEventListener("message",function(a){return console.log("on message")}),"onoffline"in window&&window.addEventListener("offline",function(a){return console.log("on offline  onLine:"+navigator.onLine)}),"ononline"in window&&window.addEventListener("online",function(a){return console.log("on online  onLine:"+navigator.onLine)}),"onstorage"in window&&window.addEventListener("storage",function(a){return console.log("on storage")}),"onload"in window?window.addEventListener("load",c["do"].load):void 0}}}).call(this),function(){var a,b,c,d;b=require("lodash"),a=function(){function a(b,c,e,f,g,h){this.box=b,this.dx=c,this.dy=e,this.absolute=null!=f?f:!1,this.duration=null!=g?g:200,null==h&&(h=++d),this.box&&(this.absolute&&(this.duration/=4),a.list[this.box.id]=this,this.box.style.zIndex=h,this.mode="show",this.from=this.hide(),this.transform(this.from),this.transition())}var e;return a.list={},a.move=function(){var b,c,d,e;d=a.list,e=[];for(b in d)c=d[b],e.push(c.translate());return e},e=function(a){var b,d,e,f;return d=this.width||this.box.offsetWidth,b=this.height||this.box.offsetHeight,this.dx?e=this.dx:(this.width=this.box.parentElement.offsetWidth,e=this.box.parentElement.offsetLeft),this.dy&&(f=this.dy),a(e,f,d,b,{top:c.top,left:c.left,width:c.width,height:c.height})},a.prototype.show=function(){return e.call(this,function(a,b,c,d,e){return 0>a&&(a+=e.width-c),0>b&&(b+=e.height-d),{x:a,y:b,w:c,h:d,win:e}})},a.prototype.hide=function(){return e.call(this,function(a,b,c,d,e){return a=-a+function(){switch(!1){case!(a>0):return-c;case!(0>a):return e.width}}(),b=-b+function(){switch(!1){case!(b>0):return-d;case!(0>b):return e.height}}(),{x:a,y:b,w:c,h:d,win:e}})},a.prototype.transform=function(a){var b,d,e;return d=a.x,e=a.y,this.width&&(this.box.style.width=this.width+"px"),this.height&&(this.box.style.height=this.height+"px"),this.absolute?(this.box.style.position="absolute",this.box.style.left=d+c.left+"px",this.box.style.top=e+c.top+"px",this.box.style.webkitTransform="",c.browser.ff&&(this.box.style.mozTransform=""),c.browser.ie&&(this.box.style.msTransform=""),c.browser.opera&&(this.box.style.oTransform=""),this.box.style.transform=""):(this.box.style.position="fixed",this.box.style.left=0,this.box.style.top=0,b="translate("+d+"px, "+e+"px)",this.box.style.webkitTransform=b,c.browser.ff&&(this.box.style.mozTransform=b),c.browser.ie&&(this.box.style.msTransform=b),c.browser.opera&&(this.box.style.oTransform=b),this.box.style.transform=b)},a.prototype.transition=function(){var a;return a=this.duration&&!this.absolute?"all "+this.duration+"ms ease-in-out 0":"",c.browser.ff&&(this.box.style.mozTransition=a),c.browser.ie&&(this.box.style.msTransition=a),c.browser.opera&&(this.box.style.oTransition=a),this.box.style.transition=a},a.prototype.translate=function(){var a;return a=this[this.mode](),b.isEqual(this.from,a)?void 0:(this.transform(a),setTimeout(function(b){return function(){return b.from=a,b.translate()}}(this),this.duration))},a}(),d=1e3,c=module.exports,c.layout=a,c.on.layout.push(a.move),c.on.scroll_end.push(a.move),c.on.resize.push(a.move)}.call(this),function(){var a,b;a=function(){function a(){this.show_upper=!0,this.size=30,this.head=this.tail=0}var c;return a.elems={},a.go=function(c,d){var e,f,g,h;return e=a.elems[c],e&&(g=e.getBoundingClientRect(),null==d&&(d=.5*Math.min(b.horizon,g.height)),h=g.top-b.horizon+d,f=0,f||h)?window.scrollBy(f,h):void 0},c=5e3,setInterval(function(){var a;return(null!=(a=b.scroll)?a.center:void 0)?b.scroll.tick(b.scroll.center,c/1e3):void 0},c),a.capture=function(){var c,d,e;return c=a.view(),e=b.scroll,null!=e&&null!=e.list&&(d=e.view(),d!==e.prop())?e.prop(d):void 0},a.view=function(){var c,d,e,f,g,h,i,j;i=null,g=a.elems;for(e in g)c=g[e],d=c.vision.id,f=c.getBoundingClientRect(),j=c.vision,j.top=f.top,j.btm=f.bottom,c.vision.id===e&&f.height&&f.width?!i&&j.top<(h=b.horizon)&&h<j.btm&&(i=d):delete a.elems[e];return i},a.prototype.rescroll=function(b){return this.prop=b,window.requestAnimationFrame(function(b){return function(){return a.go(b.prop())}}(this))},a.prototype.tick=function(a){return console.log(a)},a.prototype.view=function(){var c,d,e,f,g,h,i,j,k,l,n;for(i=this.pager_elem.getBoundingClientRect(),this.pager_top=i.top,j=this.list,f=d=0,g=j.length;g>d;f=++d)h=j[f],e=h._id,(c=a.elems[e])&&(n=c.vision,!this.adjust&&this.pager_top<(k=b.horizon)&&k<n.btm&&(n.offset=Math.max(1,b.horizon-n.top),this.adjust=n));return m.startComputation(),window.requestAnimationFrame(function(){return m.endComputation()}),null!=(l=this.adjust)?l.id:void 0},a.prototype.pager=function(a,c,d){var e,f,g,h,i,j,k,l,n,o,p,q,r,s;return this.list=c,(null!=(l=this.list)?l.length:void 0)?(q=0,f=this.list.length-1,null!=this.pager_elem&&(k=this.pager_elem.getBoundingClientRect(),n=b.height-k.bottom,p=0<k.top,o=n>0),g=_.findIndex(this.list,{_id:"function"==typeof this.prop?this.prop():void 0}),0>g&&(g=function(){if(this.past_list===this.list)switch(!1){case!p:return this.head;case!o:return this.tail;default:return this.head}else switch(!1){case!p:return q;case!o:return f;default:return q}}.call(this)),this.past_list=this.list,this.center=this.list[g],this.tail=Math.min(f,_.ceil(g+this.size,-1)),this.head=Math.max(q,g-this.size),j=function(a){return function(c,d,e){var f,g,h,i;return a.pager_elem=c,k=a.pager_elem.getBoundingClientRect(),a.show_under=k.bottom<b.horizon,a.show_upper=b.horizon<k.top,f=k.height/(1+a.tail-a.head),i=3*b.height/f,a.size<i&&console.log("!alert! scroll spy size "+a.size+" < "+i),h=k.bottom+b.top,g=h-a.elem_bottom,a.show_under&&g&&!a.prop()&&b.bottom<document.height&&window.scrollBy(0,g),a.elem_bottom=h}}(this),s=function(){var a,b,c,f,g;for(c=this.list.slice(this.head,+this.tail+1||9e9),g=[],a=0,b=c.length;b>a;a++){i=c[a],r=d(i),f=this.mark(i._id);for(h in f)e=f[h],r.attrs[h]=e;g.push(r)}return g}.call(this),m(a,{config:j},s)):m(a,{config:function(a){return function(b){a.pager_elem=b}}(this)})},a.prototype.mark=function(b){return{config:function(c){return function(d,e,f){var g;if(a.elems[b]=d,d.vision={id:b},c.adjust){if(b===c.adjust.id)return g=c.adjust.offset,c.adjust=null,a.go(b,g)}else if(!e&&b===c.prop())return window.requestAnimationFrame(function(){return a.go(b)})}}(this)}},a}(),b=module.exports,b.scroll=new a,b.on.scroll_end.push(function(){return a.capture()})}.call(this);
//# sourceMappingURL=mithril-giji.min.js.map