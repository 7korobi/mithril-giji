/**
 mithril-giji - mithril library for 人狼議事
 @version v0.0.15
 @link https://github.com/7korobi/mithril-giji
 @license 
**/
(function(){var t,o,n;o=function(t){return t.left=window.scrollX,t.top=window.scrollY},t=function(){var t,i,e,r;if(!n.scrolling)return t={},e=0,i=function(){var n;return n={},o(n),t.top===n.top&&t.left===n.left?10<e++:(t=n,e=0,!1)},(r=function(){i()?(n.scrolling=!1,n.do_event_list(n.on.scroll_end),n["do"].resize()):window.requestAnimationFrame(r)})()},module.exports=n={do_event_list:function(t,o){var n,i,e;if(0<t.length)for(i=0,e=t.length;e>i;i++)(n=t[i])(o)},"do":{layout:function(t){return n.do_event_list(n.on.layout,t)},resize:function(t){var o,i,e;return o=document.documentElement,e=Math.min(o.clientWidth,o.clientHeight),n.width=o.clientWidth,380>e&&(head.browser.viewport="width=device-width, maximum-scale=2.0, minimum-scale=0.5, initial-scale=0.5",null!=(i=document.querySelector("meta[name=viewport]"))&&(i.content=head.browser.viewport)),window.innerHeight>window.innerWidth?(n.landscape=!1,n.portlate=!0):(n.landscape=!0,n.portlate=!1),n.do_event_list(n.on.resize,t)},scroll_end:t,scroll:function(t){return o(n),n.height=window.innerHeight,n.right=n.left+window.innerWidth,n.bottom=n.top+n.height,n.horizon=n.height/2,n.scrolling||n.do_event_list(n.on.scroll_start,t),n["do"].scroll_end(),n.scrolling=!0,n.do_event_list(n.on.scroll,t)},orientation:function(t){return n.orientation=t,n.compass=t.webkitCompassHeading,n.do_event_list(n.on.orientation,t)},motion:function(t){return n.accel=t.acceleration,n.gravity=t.accelerationIncludingGravity,n.rotate=t.rotationRate,n.do_event_list(n.on.motion,t)},load:function(t){return n.do_event_list(n.on.load,t),n["do"].resize(),n["do"].scroll(),n["do"].layout()}},on:{layout:[],resize:[],scroll:[],scroll_start:[],scroll_end:[],orientation:[],motion:[],load:[]},scroll:null,layout:null,mount:function(t,o){return o?n.on.load.push(function(){var n;return n=document.querySelector(t),n&&o?m.mount(n,o(n,layout)):void 0}):void 0},top:0,horizon:0,bottom:0,left:0,right:0,height:0,width:0,accel:{},rotate:{},gravity:{},orientation:{},compass:0,is_tap:!1,deploy:function(){return"onorientationchange"in window?window.addEventListener("orientationchange",n["do"].scroll):window.addEventListener("resize",n["do"].scroll),window.addEventListener("scroll",n["do"].scroll),"ondeviceorientation"in window&&window.addEventListener("deviceorientation",n["do"].orientation),"ondevicemotion"in window&&window.addEventListener("devicemotion",n["do"].motion),"onhashchange"in window&&window.addEventListener("hashchange",function(t){return t.clipboardData?console.log(t):Url.popstate()}),"onpopstate"in window&&(window.addEventListener("popstate",function(t){return t.clipboardData?console.log(t):Url.popstate()}),head.browser.safari||Url.popstate()),"onmessage"in window&&window.addEventListener("message",function(t){return console.log("on message")}),"onoffline"in window&&window.addEventListener("offline",function(t){return console.log("on offline  onLine:"+navigator.onLine)}),"ononline"in window&&window.addEventListener("online",function(t){return console.log("on online  onLine:"+navigator.onLine)}),"onstorage"in window&&window.addEventListener("storage",function(t){return console.log("on storage")}),"onload"in window?window.addEventListener("load",n["do"].load):void 0}}}).call(this),function(){var t,o,n;t=function(){function t(o,n,i,e,r,s){this.box=o,this.dx=n,this.dy=i,this.absolute=null!=r?r:!1,this.duration=null!=s?s:DELAY.animato,this.box&&(this.absolute&&(this.duration/=4),t.list[this.box.id]=this,this.box.style.zIndex=e,this.mode="show",this.from=this.hide(),this.transform(this.from),this.transition())}var n;return t.list={},t.move=function(){var o,n,i,e;i=t.list,e=[];for(o in i)n=i[o],e.push(n.translate());return e},n=function(t){var n,i,e,r;return i=this.width||this.box.offsetWidth,n=this.height||this.box.offsetHeight,this.dx?e=this.dx:(this.width=this.box.parentElement.offsetWidth,e=this.box.parentElement.offsetLeft),this.dy&&(r=this.dy),t(e,r,i,n,{top:o.top,left:o.left,width:o.width,height:o.height})},t.prototype.show=function(){return n.call(this,function(t,o,n,i,e){return 0>t&&(t+=e.width-n),0>o&&(o+=e.height-i),{x:t,y:o,w:n,h:i,win:e}})},t.prototype.hide=function(){return n.call(this,function(t,o,n,i,e){return t=-t+function(){switch(!1){case!(t>0):return-n;case!(0>t):return e.width}}(),o=-o+function(){switch(!1){case!(o>0):return-i;case!(0>o):return e.height}}(),{x:t,y:o,w:n,h:i,win:e}})},t.prototype.transform=function(t){var n,i,e;return i=t.x,e=t.y,this.width&&(this.box.style.width=this.width+"px"),this.height&&(this.box.style.height=this.height+"px"),this.absolute?(this.box.style.position="absolute",this.box.style.left=i+o.left+"px",this.box.style.top=e+o.top+"px",this.box.style.webkitTransform="",this.box.style.mozTransform="",this.box.style.msTransform="",this.box.style.oTransform="",this.box.style.transform=""):(this.box.style.position="fixed",this.box.style.left=0,this.box.style.top=0,n="translate("+i+"px, "+e+"px)",this.box.style.webkitTransform=n,head.browser.ff&&(this.box.style.mozTransform=n),head.browser.ie&&(this.box.style.msTransform=n),head.browser.opera&&(this.box.style.oTransform=n),this.box.style.transform=n)},t.prototype.transition=function(){var t;return t=this.duration&&!this.absolute?"all "+this.duration+"ms ease-in-out 0":"",head.browser.ff&&(this.box.style.mozTransition=t),head.browser.ie&&(this.box.style.msTransition=t),head.browser.opera&&(this.box.style.oTransition=t),this.box.style.transition=t},t.prototype.translate=function(){var t;return t=this[this.mode](),_.isEqual(this.from,t)?void 0:(this.transform(t),setTimeout(function(o){return function(){return o.from=t,o.translate()}}(this),this.duration))},t}(),n=1e3,o=module.exports,o.layout=function(i,e,r,s,l,a,h){return null==s&&(s=++n),null==l&&(l=!1),null==a&&(a=200),o.mount(i,function(o){var n;return n=new t(o,e,r,s,l,a),h(o,n)})},o.on.layout.push(t.move),o.on.scroll_end.push(t.move),o.on.resize.push(t.move)}.call(this),function(){var t,o;t=function(){function t(){this.show_upper=!0,this.size=30,this.head=this.tail=0}var n;return t.elems={},t.go=function(n,i){var e,r,s,l;return e=t.elems[n],e&&(s=e.getBoundingClientRect(),null==i&&(i=.5*Math.min(o.horizon,s.height)),l=s.top-o.horizon+i,r=0,r||l)?window.scrollBy(r,l):void 0},n=5e3,setInterval(function(){var t;return(null!=(t=o.scroll)?t.center:void 0)?o.scroll.tick(o.scroll.center,n/1e3):void 0},n),t.capture=function(){var n,i,e;return n=t.view(),e=o.scroll,null!=e&&null!=e.list&&(i=e.view(),i!==e.prop())?e.prop(i):void 0},t.view=function(){var n,i,e,r,s,l,a,h;a=null,s=t.elems;for(e in s)n=s[e],i=n.vision.id,r=n.getBoundingClientRect(),h=n.vision,h.top=r.top,h.btm=r.bottom,n.vision.id===e&&r.height&&r.width?!a&&h.top<(l=o.horizon)&&l<h.btm&&(a=i):delete t.elems[e];return a},t.prototype.rescroll=function(o){return this.prop=o,window.requestAnimationFrame(function(o){return function(){return t.go(o.prop())}}(this))},t.prototype.tick=function(t){return console.log(t)},t.prototype.view=function(){var n,i,e,r,s,l,a,h,u,d,c;for(a=this.pager_elem.getBoundingClientRect(),this.pager_top=a.top,h=this.list,r=i=0,s=h.length;s>i;r=++i)l=h[r],e=l._id,(n=t.elems[e])&&(c=n.vision,!this.adjust&&this.pager_top<(u=o.horizon)&&u<c.btm&&(c.offset=Math.max(1,o.horizon-c.top),this.adjust=c));return m.startComputation(),window.requestAnimationFrame(function(){return m.endComputation()}),null!=(d=this.adjust)?d.id:void 0},t.prototype.pager=function(t,n,i){var e,r,s,l,a,h,u,d,c,f,p,w,g,v;return this.list=n,(null!=(d=this.list)?d.length:void 0)?(w=0,r=this.list.length-1,null!=this.pager_elem&&(u=this.pager_elem.getBoundingClientRect(),c=o.height-u.bottom,p=0<u.top,f=c>0),s=_.findIndex(this.list,{_id:"function"==typeof this.prop?this.prop():void 0}),0>s&&(s=function(){if(this.past_list===this.list)switch(!1){case!p:return this.head;case!f:return this.tail;default:return this.head}else switch(!1){case!p:return w;case!f:return r;default:return w}}.call(this)),this.past_list=this.list,this.center=this.list[s],this.tail=Math.min(r,_.ceil(s+this.size,-1)),this.head=Math.max(w,s-this.size),h=function(t){return function(n,i,e){var r,s,l,a;return t.pager_elem=n,u=t.pager_elem.getBoundingClientRect(),t.show_under=u.bottom<o.horizon,t.show_upper=o.horizon<u.top,r=u.height/(1+t.tail-t.head),a=3*o.height/r,t.size<a&&console.log("!alert! scroll spy size "+t.size+" < "+a),l=u.bottom+o.top,s=l-t.elem_bottom,t.show_under&&s&&!t.prop()&&o.bottom<document.height&&window.scrollBy(0,s),t.elem_bottom=l}}(this),v=function(){var t,o,n,r,s;for(n=this.list.slice(this.head,+this.tail+1||9e9),s=[],t=0,o=n.length;o>t;t++){a=n[t],g=i(a),r=this.mark(a._id);for(l in r)e=r[l],g.attrs[l]=e;s.push(g)}return s}.call(this),m(t,{config:h},v)):m(t,{config:function(t){return function(o){t.pager_elem=o}}(this)})},t.prototype.mark=function(o){return{config:function(n){return function(i,e,r){var s;if(t.elems[o]=i,i.vision={id:o},n.adjust){if(o===n.adjust.id)return s=n.adjust.offset,n.adjust=null,t.go(o,s)}else if(!e&&o===n.prop())return window.requestAnimationFrame(function(){return t.go(o)})}}(this)}},t}(),o=module.exports,o.scroll=new t,o.on.scroll_end.push(function(){return t.capture()})}.call(this);